<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Heat Exchanger Calculator - 套管换热器计算器</title>
  <link rel="icon" type="image/svg+xml" href="/vite.svg">
</head>
<body>
  <div id="app">
    <!-- 加载状态 -->
    <div id="loading" class="fixed inset-0 bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center z-50">
      <div class="text-center">
        <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-600 mx-auto mb-4"></div>
        <p class="text-gray-700 text-lg font-medium">正在加载 CoolProp...</p>
      </div>
    </div>

    <!-- 主应用容器 -->
    <div id="main-app" class="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 py-8 px-4 hidden">
      <div class="max-w-6xl mx-auto">
        <!-- 标题区域 -->
        <header class="text-center mb-8">
          <h1 class="text-4xl font-bold text-gray-800 mb-2">套管换热器计算器</h1>
          <p class="text-gray-600">Heat Exchanger Calculator</p>
          <!-- 示例案例按钮 -->
          <div class="mt-4 flex justify-center gap-3 flex-wrap">
            <button id="load-example-straight" class="px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors text-sm font-medium">
              加载示例：直管换热器
            </button>
            <button id="load-example-twisted" class="px-4 py-2 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition-colors text-sm font-medium">
              加载示例：麻花管换热器
            </button>
          </div>
        </header>

        <!-- 输入区域 -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
          <!-- 热流体参数 -->
          <div class="bg-white rounded-2xl shadow-lg p-6">
            <h2 class="text-2xl font-semibold text-gray-800 mb-4 flex items-center">
              <span class="w-3 h-3 bg-red-500 rounded-full mr-2"></span>
              热流体参数
            </h2>
            <div class="space-y-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">工质</label>
                <select id="hot-fluid" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white">
                  <option value="Water">水 (Water)</option>
                  <option value="R134a">R134a</option>
                  <option value="R410A">R410A</option>
                  <option value="Air">空气 (Air)</option>
                  <option value="Ethanol">乙醇 (Ethanol)</option>
                  <option value="Methanol">甲醇 (Methanol)</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">入口温度 (°C)</label>
                <input type="number" id="hot-tin" step="0.1" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="80">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">出口温度 (°C)</label>
                <input type="number" id="hot-tout" step="0.1" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="60">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">质量流量 (kg/s)</label>
                <input type="number" id="hot-flowrate" step="0.01" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="0.5">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">压力 (kPa)</label>
                <input type="number" id="hot-pressure" step="0.1" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="101.325" value="101.325">
              </div>
            </div>
          </div>

          <!-- 冷流体参数 -->
          <div class="bg-white rounded-2xl shadow-lg p-6">
            <h2 class="text-2xl font-semibold text-gray-800 mb-4 flex items-center">
              <span class="w-3 h-3 bg-blue-500 rounded-full mr-2"></span>
              冷流体参数
            </h2>
            <div class="space-y-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">工质</label>
                <select id="cold-fluid" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white">
                  <option value="Water">水 (Water)</option>
                  <option value="R134a">R134a</option>
                  <option value="R410A">R410A</option>
                  <option value="Air">空气 (Air)</option>
                  <option value="Ethanol">乙醇 (Ethanol)</option>
                  <option value="Methanol">甲醇 (Methanol)</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">入口温度 (°C)</label>
                <input type="number" id="cold-tin" step="0.1" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="20">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">出口温度 (°C)</label>
                <input type="number" id="cold-tout" step="0.1" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="40">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">质量流量 (kg/s)</label>
                <input type="number" id="cold-flowrate" step="0.01" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="0.5">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">压力 (kPa)</label>
                <input type="number" id="cold-pressure" step="0.1" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="101.325" value="101.325">
              </div>
            </div>
          </div>
        </div>

        <!-- 换热器参数 -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
          <h2 class="text-2xl font-semibold text-gray-800 mb-4 flex items-center">
            <span class="w-3 h-3 bg-green-500 rounded-full mr-2"></span>
            换热器参数
          </h2>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">内管直径 (mm)</label>
              <input type="number" id="inner-diameter" step="0.1" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="20" value="20">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">外管直径 (mm)</label>
              <input type="number" id="outer-diameter" step="0.1" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="40" value="40">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">管长 (m)</label>
              <input type="number" id="length" step="0.1" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="5.0" value="5.0">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">流动方式</label>
              <select id="flow-type" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white">
                <option value="counter">逆流 (Counter Flow)</option>
                <option value="parallel">并流 (Parallel Flow)</option>
              </select>
            </div>
          </div>
          <div class="mt-4">
            <label class="block text-sm font-medium text-gray-700 mb-2">传热系数 (W/m²·K) <span class="text-gray-500 text-xs">(可选，留空则自动计算)</span></label>
            <input type="number" id="heat-transfer-coefficient" step="0.1" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="留空自动计算">
          </div>
          
          <!-- 麻花管参数 -->
          <div class="mt-6 pt-6 border-t border-gray-200">
            <div class="flex items-center mb-4">
              <input type="checkbox" id="twisted-tube-mode" class="w-5 h-5 text-blue-600 rounded focus:ring-blue-500">
              <label for="twisted-tube-mode" class="ml-2 text-lg font-semibold text-gray-800">启用麻花管模式</label>
            </div>
            <div id="twisted-tube-params" class="grid grid-cols-1 md:grid-cols-2 gap-4 hidden">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">螺旋节距 (m) <span class="text-gray-500 text-xs">(一个完整螺旋的长度)</span></label>
                <input type="number" id="twist-pitch" step="0.01" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="0.1" value="0.1">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">螺旋角度 (°) <span class="text-gray-500 text-xs">(扭曲角度，通常 30-60°)</span></label>
                <input type="number" id="twist-angle" step="1" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="45" value="45">
              </div>
            </div>
          </div>
        </div>

        <!-- 可视化区域：一张综合结构图 -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
          <h2 class="text-2xl font-semibold text-gray-800 mb-2 flex items-center">
            <span class="w-3 h-3 bg-indigo-500 rounded-full mr-2"></span>
            换热器结构与工况示意图
          </h2>
          <p class="text-sm text-gray-500 mb-4">
            一张图同时展示几何尺寸（长度、内外径）、流动方向、进出口温度以及计算结果（Q、LMTD、U）。
          </p>
          <div class="w-full">
            <canvas
              id="side-view-canvas"
              class="w-full border border-gray-200 rounded-lg bg-gray-50"
              style="height: 500px;"
            ></canvas>
          </div>
        </div>

        <!-- 计算按钮 -->
        <div class="text-center mb-6">
          <button id="calculate-btn" class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-8 py-4 rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 font-semibold text-lg disabled:opacity-50 disabled:cursor-not-allowed">
            计算
          </button>
        </div>

        <!-- 结果展示区域 -->
        <div id="results" class="bg-white rounded-2xl shadow-lg p-6 hidden">
          <h2 class="text-2xl font-semibold text-gray-800 mb-4 flex items-center">
            <span class="w-3 h-3 bg-purple-500 rounded-full mr-2"></span>
            计算结果
          </h2>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-4">
              <div class="text-sm text-gray-600 mb-1">传热量</div>
              <div id="result-q" class="text-2xl font-bold text-blue-700">-</div>
              <div class="text-xs text-gray-500 mt-1">kW</div>
            </div>
            <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-4">
              <div class="text-sm text-gray-600 mb-1">对数平均温差</div>
              <div id="result-lmtd" class="text-2xl font-bold text-green-700">-</div>
              <div class="text-xs text-gray-500 mt-1">°C</div>
            </div>
            <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4">
              <div class="text-sm text-gray-600 mb-1">传热系数</div>
              <div id="result-u" class="text-2xl font-bold text-purple-700">-</div>
              <div class="text-xs text-gray-500 mt-1">W/m²·K</div>
            </div>
            <div class="bg-gradient-to-br from-orange-50 to-orange-100 rounded-xl p-4">
              <div class="text-sm text-gray-600 mb-1">换热面积</div>
              <div id="result-area" class="text-2xl font-bold text-orange-700">-</div>
              <div class="text-xs text-gray-500 mt-1">m²</div>
            </div>
          </div>
          <div id="error-message" class="mt-4 p-4 bg-red-50 border border-red-200 rounded-xl text-red-700 hidden"></div>
        </div>
      </div>
    </div>
  </div>
  <script type="module" src="/src/main.js"></script>
</body>
</html>

